# FireEyeExploitScanner
Powershell script to automate deployment of Yara to scan files for FireEye Exploit using FireEye Exploit Yara Rules

## CREDITS
Credit to VirusTotal for their yara scan tool: https://github.com/VirusTotal/yara

Credit to FireEye for their yara rules file: https://github.com/fireeye/red_team_tool_countermeasures

Credit to Datto and Seagull for inspiration: https://github.com/datto/fireeye-red-team-countermeasure-scanner

## ABOUT
This is a powershell script that can be run on any device running Windows OS with Powershell to scan processes or files against the list of FireEye's yara rule to determine if any files match the FireEye's Red Team Exploit yara rule. 
Matches may not necessarily mean the file is an actual exploit.
The script will log the script actions to a log file specified in the variable $Script:POpsLogFile.
The script will gather the results from all files scanned with Yara and output to a csv file located in the folder that is specified in the parameter -DestinationFolder.
The script itself doesn't have any arameters, instead, there are functions within the script that are called. 
The only function you need to specify parameters for is "Invoke-POpsYaraScan"

If using with an RMM, set up **input variables** to map to the following script variables:
$InScanLevel
$InFileType

**Output variables for RMM are**
$OutExploitFound
$OutLogFolder
