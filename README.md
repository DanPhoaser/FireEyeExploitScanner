# FireEye Red Team Exploit Scanner
Powershell script to automate deployment of Yara to scan files for FireEye Exploit using FireEye Exploit Yara Rules

## CREDITS
Credit to VirusTotal for their yara scan tool: https://github.com/VirusTotal/yara

Credit to FireEye for their yara rules file: https://github.com/fireeye/red_team_tool_countermeasures

Credit to Datto and Seagull for inspiration: https://github.com/datto/fireeye-red-team-countermeasure-scanner

## ABOUT
This is a powershell script that can be run on any device running Windows OS with Powershell to scan processes or files against the list of FireEye's yara rule to determine if any files match the FireEye's Red Team Exploit yara rule. 

Matches may not necessarily mean the file is an actual exploit.

The script will log the script actions to a log file specified in the variable $Script:POpsLogFile.
The script will gather the results from all files scanned with Yara and output to a csv file located in the folder that is specified in the parameter -DestinationFolder.
The script itself doesn't have any parameters, instead, there are functions within the script that are called with pre-defined parameters. 

The only function you need to specify parameters for is **"Invoke-POpsYaraScan"** function, called at the bottom of the script.

If using with an RMM, set up input and output variables to map to the following script variables:

**Input variables** 
* $InScanLevel
* $InFileType

**Output variables**
* $OutExploitFound
* $OutLogFolder

## REQUIREMENTS
Only tested with Powershell on Windows 7 and up and Windows Server 2008 R2 and up.
You will need to grab the latest Yara 64 and x86 exes from here:
https://github.com/VirusTotal/yara/releases/

You will need extract each zip and name the yara exe files:
* yara64.exe
* yara32.exe

Then, host the yara64.exe and yara32.exe files somewhere safe and secure that allows https download.
Keep note of the download urls for both the yara64.exe, and yara32.exe as you will have to provide the urls as parameter values for the **"Invoke-POpsYaraScan"** function, called at the bottom of the script.
